{"ast":null,"code":"var _jsxFileName = \"/Users/Hedi/Documents/S/WS20:21/Study/src/components/Tracker.js\";\nimport React, { Component } from \"react\";\nimport EmailClient from \"./emailClient\";\n\nclass Tracker extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getUserID = () => {\n      const requestOptions = {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      };\n      fetch(\"/connect\", requestOptions).then(response => response.json()).then(data => this.setState({\n        userId: data.userID\n      })).then(() => this.props.userID(this.state.userId));\n    };\n\n    this.getNickname = () => {\n      //set nickname from props\n      let nickname = this.props.userInfo.userName;\n      this.setState({\n        userNickname: nickname\n      });\n    };\n\n    this.startCalibration = () => {\n      this.startTracking();\n    };\n\n    this.startTracking = () => {\n      this.collectionInterval = setInterval(this.collectStates, 250);\n      this.sendingIntervall = setInterval(this.sendData, 5000);\n    };\n\n    this.sendData = () => {\n      //Send to Server\n      const data = this.stateCollector;\n      const response = fetch(\"/data\", {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(data)\n      }).then(this.resetCollector);\n    };\n\n    this.collectStates = () => {\n      this.setAllInfo();\n      this.fillCollector();\n      this.resetStates();\n    };\n\n    this.setAllInfo = () => {\n      this.settingsChecker();\n      this.setTimestamp();\n    };\n\n    this.setTimestamp = () => {\n      let currentTime = new Date();\n      let newDate = currentTime.getTime();\n      this.setState({\n        timeStamp: newDate\n      });\n    };\n\n    this.fillCollector = () => {\n      this.stateCollector.push(this.state);\n    };\n\n    this.resetCollector = () => {\n      this.stateCollector = [];\n    };\n\n    this.resetStates = () => {\n      this.setState({\n        click: false,\n        clickPosXTransform: 0,\n        clickPosYTransform: 0,\n        clickPosX: 0,\n        clickPosY: 0\n      });\n    };\n\n    this.settingsChecker = () => {\n      let width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n      let height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n      let marginTop = window.screenTop;\n      let marginLeft = window.screenLeft;\n      let yScroll = Math.round(window.scrollY);\n      this.setState({\n        browserWidth: width,\n        browserHeight: height,\n        marginToScreenLeft: marginLeft,\n        marginToScreenTop: marginTop,\n        pageScrollY: yScroll\n      });\n      this.setTransformedMousePos(this.state.mousePosXPlain, this.state.mousePosYPlain);\n      this.setinEmailPositionY();\n    };\n\n    this.setinEmailPositionY = () => {\n      let inEmailPositionY = this.state.mousePosYPlain + this.state.inEmailScrollAmount;\n      this.setState({\n        inEmailPositionY: inEmailPositionY\n      });\n    };\n\n    this.SetInEmailScrollAmount = scrollAmount => {\n      let roundScrollAmount = Math.round(scrollAmount);\n      this.setState({\n        inEmailScrollAmount: roundScrollAmount\n      });\n    };\n\n    this.setTransformedMousePos = (x, y) => {\n      let clientWidth = 980;\n\n      if (x > this.state.browserWidth / 2 + clientWidth / 2) {\n        var xTran = (x - (this.state.browserWidth / 2 + clientWidth / 2)) * -1;\n        var yTran = y + this.state.pageScrollY;\n      } else {\n        var xTran = (this.state.browserWidth / 2 - clientWidth / 2 - x) * -1;\n        var yTran = y + this.state.pageScrollY;\n      }\n\n      this.setState({\n        mousePosXTransform: xTran,\n        mousePosYTransform: yTran\n      });\n    };\n\n    this.handleNewCurrentEmail = emailNr => {\n      let copy = this.state;\n      copy.currentEmail = emailNr;\n      this.setState(copy);\n    };\n\n    this.handleNewCurrentInbox = inboxType => {\n      let copy = this.state;\n      copy.currentInbox = inboxType;\n      copy.currentEmail = 0;\n      this.setState(copy);\n    };\n\n    this.handleInboxResult = finalInboxLocal => {\n      this.resultInbox.resultInbox = finalInboxLocal;\n      this.resultInbox.resultInbox.forEach(element => {\n        element.keyID = element.mail.defaultProps.keyID;\n        element.unseen = element.mail.defaultProps.unseen;\n      });\n      this.resultInbox.userID = this.state.userId;\n      this.sendFinalInbox();\n      clearInterval(this.collectionInterval);\n      clearInterval(this.sendingIntervall);\n    };\n\n    this.sendFinalInbox = () => {\n      //Send to Server\n      const data = this.resultInbox;\n      const response = fetch(\"/resultInbox\", {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(data)\n      }).then(console.log(\"sent result Inbox\"));\n    };\n\n    this.handleInsideEmailInfo = (InOrOutput, whichPart) => {\n      if (InOrOutput === true) {\n        let copy = this.state;\n\n        if (whichPart.includes(\"ClickedLink\")) {\n          copy.insideEmailInfo.push(whichPart);\n          const timerForClickedLink = setTimeout(() => {\n            this.deletefromInsideEmailInfo(whichPart);\n          }, 1000);\n          this.setState(copy);\n          this.sendData();\n          return;\n        }\n\n        if (!copy.insideEmailInfo.includes(whichPart)) {\n          copy.insideEmailInfo.push(whichPart);\n        } else {}\n\n        this.setState(copy);\n      } else {\n        this.deletefromInsideEmailInfo(whichPart);\n      }\n    };\n\n    this.handleOutsideEmailInfo = (InOrOutput, whichPart) => {\n      if (InOrOutput === true) {\n        let copy = this.state;\n        copy.outsideEmailInfo.push(whichPart);\n        this.setState(copy);\n      } else {\n        this.deletefromOutsideEmailInfo(whichPart);\n      }\n    };\n\n    this.deletefromInsideEmailInfo = whichToDelete => {\n      let copy = this.state;\n      const index = copy.insideEmailInfo.indexOf(whichToDelete);\n\n      if (index > -1) {\n        copy.insideEmailInfo.splice(index, 1);\n      }\n\n      this.setState(copy);\n    };\n\n    this.deletefromOutsideEmailInfo = whichToDelete => {\n      let copy = this.state;\n      const index = copy.outsideEmailInfo.indexOf(whichToDelete);\n\n      if (index > -1) {\n        copy.outsideEmailInfo.splice(index, 1);\n      }\n\n      this.setState(copy);\n    };\n\n    this.handleClickedInboxButton = (whichButton, insideWhichButton) => {\n      let copy = this.state;\n      copy.insideEmailInfo.push(whichButton);\n      this.setState(copy);\n      const timer2 = setTimeout(() => {\n        this.deletefromInsideEmailInfo(whichButton);\n      }, 1050);\n    };\n\n    this.handleMouseMove = this.handleMouseMove.bind(this);\n    this.handleMouseClick = this.handleMouseClick.bind(this);\n    this.state = {\n      currentEmail: 0,\n      //event dependant\n      currentInbox: \"AllInbox\",\n      insideEmailInfo: [],\n      outsideEmailInfo: [],\n      //event dependant\n      mousePosXPlain: 0,\n      mousePosYPlain: 0,\n      mousePosXTransform: 0,\n      mousePosYTransform: 0,\n      click: false,\n      clickPosXTransform: 0,\n      clickPosYTransform: 0,\n      clickPosX: 0,\n      clickPosY: 0,\n      timeStamp: 0,\n      userId: 0,\n      userNickname: \"\",\n      pageScrollY: 0,\n      browserWidth: 0,\n      browserHeight: 0,\n      marginToScreenTop: 0,\n      marginToScreenLeft: 0,\n      inEmailScrollAmount: 0,\n      inEmailPositionY: 0,\n      submitted: true\n    };\n    this.resultInbox = {\n      resultInbox: [],\n      userID: 0\n    };\n    this.stateCollector = [];\n    this.collectionInterval = undefined;\n    this.sendingInterval = undefined;\n    this.accuracyIntervall = undefined;\n    this.collectingAccuracy = false;\n  }\n\n  componentDidMount() {\n    this.getUserID();\n    this.getNickname();\n    this.startCalibration();\n    this.props.userID(this.state.userId);\n  }\n\n  handleMouseMove(event) {\n    let x = event.clientX;\n    let y = event.clientY;\n    this.setState({\n      mousePosXPlain: x,\n      mousePosYPlain: y\n    });\n  }\n\n  handleMouseClick(event) {\n    let copy = this.state;\n    this.handleMouseMove(event);\n    this.setTransformedMousePos(this.state.mousePosXPlain, this.state.mousePosYPlain);\n    copy.click = true;\n    copy.clickPosX = this.state.mousePosXPlain;\n    copy.clickPosY = this.state.mousePosYPlain;\n    this.setState(copy);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      onMouseMove: this.handleMouseMove,\n      onClick: this.handleMouseClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(EmailClient, {\n      clickedButton: this.handleClickedInboxButton,\n      inEmailScrollAmount: this.SetInEmailScrollAmount,\n      UserInfo: this.props.userInfo,\n      onNewEmail: this.handleNewCurrentEmail,\n      onNewInbox: this.handleNewCurrentInbox,\n      setInboxResult: this.handleInboxResult,\n      insideEmailInfo: this.handleInsideEmailInfo,\n      outsideEmailInfo: this.handleOutsideEmailInfo,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default Tracker;","map":{"version":3,"sources":["/Users/Hedi/Documents/S/WS20:21/Study/src/components/Tracker.js"],"names":["React","Component","EmailClient","Tracker","constructor","props","getUserID","requestOptions","method","headers","fetch","then","response","json","data","setState","userId","userID","state","getNickname","nickname","userInfo","userName","userNickname","startCalibration","startTracking","collectionInterval","setInterval","collectStates","sendingIntervall","sendData","stateCollector","Accept","body","JSON","stringify","resetCollector","setAllInfo","fillCollector","resetStates","settingsChecker","setTimestamp","currentTime","Date","newDate","getTime","timeStamp","push","click","clickPosXTransform","clickPosYTransform","clickPosX","clickPosY","width","window","innerWidth","document","documentElement","clientWidth","height","innerHeight","clientHeight","marginTop","screenTop","marginLeft","screenLeft","yScroll","Math","round","scrollY","browserWidth","browserHeight","marginToScreenLeft","marginToScreenTop","pageScrollY","setTransformedMousePos","mousePosXPlain","mousePosYPlain","setinEmailPositionY","inEmailPositionY","inEmailScrollAmount","SetInEmailScrollAmount","scrollAmount","roundScrollAmount","x","y","xTran","yTran","mousePosXTransform","mousePosYTransform","handleNewCurrentEmail","emailNr","copy","currentEmail","handleNewCurrentInbox","inboxType","currentInbox","handleInboxResult","finalInboxLocal","resultInbox","forEach","element","keyID","mail","defaultProps","unseen","sendFinalInbox","clearInterval","console","log","handleInsideEmailInfo","InOrOutput","whichPart","includes","insideEmailInfo","timerForClickedLink","setTimeout","deletefromInsideEmailInfo","handleOutsideEmailInfo","outsideEmailInfo","deletefromOutsideEmailInfo","whichToDelete","index","indexOf","splice","handleClickedInboxButton","whichButton","insideWhichButton","timer2","handleMouseMove","bind","handleMouseClick","submitted","undefined","sendingInterval","accuracyIntervall","collectingAccuracy","componentDidMount","event","clientX","clientY","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,WAAP,MAAwB,eAAxB;;AAEA,MAAMC,OAAN,SAAsBF,SAAtB,CAAgC;AAC9BG,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SA+CnBC,SA/CmB,GA+CP,MAAM;AAChB,YAAMC,cAAc,GAAG;AACrBC,QAAAA,MAAM,EAAE,KADa;AAErBC,QAAAA,OAAO,EAAE;AAAE,0BAAgB;AAAlB;AAFY,OAAvB;AAKAC,MAAAA,KAAK,CAAC,UAAD,EAAaH,cAAb,CAAL,CACGI,IADH,CACSC,QAAD,IAAcA,QAAQ,CAACC,IAAT,EADtB,EAEGF,IAFH,CAESG,IAAD,IAAU,KAAKC,QAAL,CAAc;AAAEC,QAAAA,MAAM,EAAEF,IAAI,CAACG;AAAf,OAAd,CAFlB,EAGGN,IAHH,CAGQ,MAAM,KAAKN,KAAL,CAAWY,MAAX,CAAkB,KAAKC,KAAL,CAAWF,MAA7B,CAHd;AAID,KAzDkB;;AAAA,SA2DnBG,WA3DmB,GA2DL,MAAM;AAClB;AACA,UAAIC,QAAQ,GAAG,KAAKf,KAAL,CAAWgB,QAAX,CAAoBC,QAAnC;AACA,WAAKP,QAAL,CAAc;AAAEQ,QAAAA,YAAY,EAAEH;AAAhB,OAAd;AACD,KA/DkB;;AAAA,SAiEnBI,gBAjEmB,GAiEA,MAAM;AACvB,WAAKC,aAAL;AACD,KAnEkB;;AAAA,SAqEnBA,aArEmB,GAqEH,MAAM;AACpB,WAAKC,kBAAL,GAA0BC,WAAW,CAAC,KAAKC,aAAN,EAAqB,GAArB,CAArC;AACA,WAAKC,gBAAL,GAAwBF,WAAW,CAAC,KAAKG,QAAN,EAAgB,IAAhB,CAAnC;AACD,KAxEkB;;AAAA,SA0EnBA,QA1EmB,GA0ER,MAAM;AACf;AACA,YAAMhB,IAAI,GAAG,KAAKiB,cAAlB;AACA,YAAMnB,QAAQ,GAAGF,KAAK,CAAC,OAAD,EAAU;AAC9BF,QAAAA,MAAM,EAAE,MADsB;AAE9BC,QAAAA,OAAO,EAAE;AACPuB,UAAAA,MAAM,EAAE,kBADD;AAEP,0BAAgB;AAFT,SAFqB;AAM9BC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAerB,IAAf;AANwB,OAAV,CAAL,CAOdH,IAPc,CAOT,KAAKyB,cAPI,CAAjB;AAQD,KArFkB;;AAAA,SAuFnBR,aAvFmB,GAuFH,MAAM;AACpB,WAAKS,UAAL;AACA,WAAKC,aAAL;AACA,WAAKC,WAAL;AACD,KA3FkB;;AAAA,SA6FnBF,UA7FmB,GA6FN,MAAM;AACjB,WAAKG,eAAL;AACA,WAAKC,YAAL;AACD,KAhGkB;;AAAA,SAkGnBA,YAlGmB,GAkGJ,MAAM;AACnB,UAAIC,WAAW,GAAG,IAAIC,IAAJ,EAAlB;AACA,UAAIC,OAAO,GAAGF,WAAW,CAACG,OAAZ,EAAd;AACA,WAAK9B,QAAL,CAAc;AAAE+B,QAAAA,SAAS,EAAEF;AAAb,OAAd;AACD,KAtGkB;;AAAA,SAwGnBN,aAxGmB,GAwGH,MAAM;AACpB,WAAKP,cAAL,CAAoBgB,IAApB,CAAyB,KAAK7B,KAA9B;AACD,KA1GkB;;AAAA,SA4GnBkB,cA5GmB,GA4GF,MAAM;AACrB,WAAKL,cAAL,GAAsB,EAAtB;AACD,KA9GkB;;AAAA,SAgHnBQ,WAhHmB,GAgHL,MAAM;AAClB,WAAKxB,QAAL,CAAc;AACZiC,QAAAA,KAAK,EAAE,KADK;AAEZC,QAAAA,kBAAkB,EAAE,CAFR;AAGZC,QAAAA,kBAAkB,EAAE,CAHR;AAIZC,QAAAA,SAAS,EAAE,CAJC;AAKZC,QAAAA,SAAS,EAAE;AALC,OAAd;AAOD,KAxHkB;;AAAA,SAgInBZ,eAhImB,GAgID,MAAM;AACtB,UAAIa,KAAK,GACPC,MAAM,CAACC,UAAP,IACAC,QAAQ,CAACC,eAAT,CAAyBC,WADzB,IAEAF,QAAQ,CAACvB,IAAT,CAAcyB,WAHhB;AAKA,UAAIC,MAAM,GACRL,MAAM,CAACM,WAAP,IACAJ,QAAQ,CAACC,eAAT,CAAyBI,YADzB,IAEAL,QAAQ,CAACvB,IAAT,CAAc4B,YAHhB;AAKA,UAAIC,SAAS,GAAGR,MAAM,CAACS,SAAvB;AACA,UAAIC,UAAU,GAAGV,MAAM,CAACW,UAAxB;AAEA,UAAIC,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWd,MAAM,CAACe,OAAlB,CAAd;AAEA,WAAKtD,QAAL,CAAc;AACZuD,QAAAA,YAAY,EAAEjB,KADF;AAEZkB,QAAAA,aAAa,EAAEZ,MAFH;AAGZa,QAAAA,kBAAkB,EAAER,UAHR;AAIZS,QAAAA,iBAAiB,EAAEX,SAJP;AAKZY,QAAAA,WAAW,EAAER;AALD,OAAd;AAQA,WAAKS,sBAAL,CACE,KAAKzD,KAAL,CAAW0D,cADb,EAEE,KAAK1D,KAAL,CAAW2D,cAFb;AAKA,WAAKC,mBAAL;AACD,KA9JkB;;AAAA,SAgKnBA,mBAhKmB,GAgKG,MAAM;AAC1B,UAAIC,gBAAgB,GAClB,KAAK7D,KAAL,CAAW2D,cAAX,GAA4B,KAAK3D,KAAL,CAAW8D,mBADzC;AAEA,WAAKjE,QAAL,CAAc;AAAEgE,QAAAA,gBAAgB,EAAEA;AAApB,OAAd;AACD,KApKkB;;AAAA,SAsKnBE,sBAtKmB,GAsKOC,YAAD,IAAkB;AACzC,UAAIC,iBAAiB,GAAGhB,IAAI,CAACC,KAAL,CAAWc,YAAX,CAAxB;AACA,WAAKnE,QAAL,CAAc;AAAEiE,QAAAA,mBAAmB,EAAEG;AAAvB,OAAd;AACD,KAzKkB;;AAAA,SA2KnBR,sBA3KmB,GA2KM,CAACS,CAAD,EAAIC,CAAJ,KAAU;AACjC,UAAI3B,WAAW,GAAG,GAAlB;;AACA,UAAI0B,CAAC,GAAG,KAAKlE,KAAL,CAAWoD,YAAX,GAA0B,CAA1B,GAA8BZ,WAAW,GAAG,CAApD,EAAuD;AACrD,YAAI4B,KAAK,GAAG,CAACF,CAAC,IAAI,KAAKlE,KAAL,CAAWoD,YAAX,GAA0B,CAA1B,GAA8BZ,WAAW,GAAG,CAAhD,CAAF,IAAwD,CAAC,CAArE;AACA,YAAI6B,KAAK,GAAGF,CAAC,GAAG,KAAKnE,KAAL,CAAWwD,WAA3B;AACD,OAHD,MAGO;AACL,YAAIY,KAAK,GAAG,CAAC,KAAKpE,KAAL,CAAWoD,YAAX,GAA0B,CAA1B,GAA8BZ,WAAW,GAAG,CAA5C,GAAgD0B,CAAjD,IAAsD,CAAC,CAAnE;AACA,YAAIG,KAAK,GAAGF,CAAC,GAAG,KAAKnE,KAAL,CAAWwD,WAA3B;AACD;;AACD,WAAK3D,QAAL,CAAc;AAAEyE,QAAAA,kBAAkB,EAAEF,KAAtB;AAA6BG,QAAAA,kBAAkB,EAAEF;AAAjD,OAAd;AACD,KArLkB;;AAAA,SAoMnBG,qBApMmB,GAoMMC,OAAD,IAAa;AACnC,UAAIC,IAAI,GAAG,KAAK1E,KAAhB;AACA0E,MAAAA,IAAI,CAACC,YAAL,GAAoBF,OAApB;AACA,WAAK5E,QAAL,CAAc6E,IAAd;AACD,KAxMkB;;AAAA,SA0MnBE,qBA1MmB,GA0MMC,SAAD,IAAe;AACrC,UAAIH,IAAI,GAAG,KAAK1E,KAAhB;AACA0E,MAAAA,IAAI,CAACI,YAAL,GAAoBD,SAApB;AACAH,MAAAA,IAAI,CAACC,YAAL,GAAoB,CAApB;AACA,WAAK9E,QAAL,CAAc6E,IAAd;AACD,KA/MkB;;AAAA,SAiNnBK,iBAjNmB,GAiNEC,eAAD,IAAqB;AACvC,WAAKC,WAAL,CAAiBA,WAAjB,GAA+BD,eAA/B;AACA,WAAKC,WAAL,CAAiBA,WAAjB,CAA6BC,OAA7B,CAAsCC,OAAD,IAAa;AAChDA,QAAAA,OAAO,CAACC,KAAR,GAAgBD,OAAO,CAACE,IAAR,CAAaC,YAAb,CAA0BF,KAA1C;AACAD,QAAAA,OAAO,CAACI,MAAR,GAAiBJ,OAAO,CAACE,IAAR,CAAaC,YAAb,CAA0BC,MAA3C;AACD,OAHD;AAIA,WAAKN,WAAL,CAAiBlF,MAAjB,GAA0B,KAAKC,KAAL,CAAWF,MAArC;AACA,WAAK0F,cAAL;AACAC,MAAAA,aAAa,CAAC,KAAKjF,kBAAN,CAAb;AACAiF,MAAAA,aAAa,CAAC,KAAK9E,gBAAN,CAAb;AACD,KA3NkB;;AAAA,SA6NnB6E,cA7NmB,GA6NF,MAAM;AACrB;AAEA,YAAM5F,IAAI,GAAG,KAAKqF,WAAlB;AACA,YAAMvF,QAAQ,GAAGF,KAAK,CAAC,cAAD,EAAiB;AACrCF,QAAAA,MAAM,EAAE,MAD6B;AAErCC,QAAAA,OAAO,EAAE;AACPuB,UAAAA,MAAM,EAAE,kBADD;AAEP,0BAAgB;AAFT,SAF4B;AAMrCC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAerB,IAAf;AAN+B,OAAjB,CAAL,CAOdH,IAPc,CAOTiG,OAAO,CAACC,GAAR,CAAY,mBAAZ,CAPS,CAAjB;AAQD,KAzOkB;;AAAA,SA2OnBC,qBA3OmB,GA2OK,CAACC,UAAD,EAAaC,SAAb,KAA2B;AACjD,UAAID,UAAU,KAAK,IAAnB,EAAyB;AACvB,YAAInB,IAAI,GAAG,KAAK1E,KAAhB;;AACA,YAAI8F,SAAS,CAACC,QAAV,CAAmB,aAAnB,CAAJ,EAAuC;AACrCrB,UAAAA,IAAI,CAACsB,eAAL,CAAqBnE,IAArB,CAA0BiE,SAA1B;AACA,gBAAMG,mBAAmB,GAAGC,UAAU,CAAC,MAAM;AAC3C,iBAAKC,yBAAL,CAA+BL,SAA/B;AACD,WAFqC,EAEnC,IAFmC,CAAtC;AAGA,eAAKjG,QAAL,CAAc6E,IAAd;AACA,eAAK9D,QAAL;AACA;AACD;;AACD,YAAI,CAAC8D,IAAI,CAACsB,eAAL,CAAqBD,QAArB,CAA8BD,SAA9B,CAAL,EAA+C;AAC7CpB,UAAAA,IAAI,CAACsB,eAAL,CAAqBnE,IAArB,CAA0BiE,SAA1B;AACD,SAFD,MAEO,CACN;;AACD,aAAKjG,QAAL,CAAc6E,IAAd;AACD,OAhBD,MAgBO;AACL,aAAKyB,yBAAL,CAA+BL,SAA/B;AACD;AACF,KA/PkB;;AAAA,SAiQnBM,sBAjQmB,GAiQM,CAACP,UAAD,EAAaC,SAAb,KAA2B;AAClD,UAAID,UAAU,KAAK,IAAnB,EAAyB;AACvB,YAAInB,IAAI,GAAG,KAAK1E,KAAhB;AACA0E,QAAAA,IAAI,CAAC2B,gBAAL,CAAsBxE,IAAtB,CAA2BiE,SAA3B;AACA,aAAKjG,QAAL,CAAc6E,IAAd;AACD,OAJD,MAIO;AACL,aAAK4B,0BAAL,CAAgCR,SAAhC;AACD;AACF,KAzQkB;;AAAA,SA2QnBK,yBA3QmB,GA2QUI,aAAD,IAAmB;AAC7C,UAAI7B,IAAI,GAAG,KAAK1E,KAAhB;AACA,YAAMwG,KAAK,GAAG9B,IAAI,CAACsB,eAAL,CAAqBS,OAArB,CAA6BF,aAA7B,CAAd;;AACA,UAAIC,KAAK,GAAG,CAAC,CAAb,EAAgB;AACd9B,QAAAA,IAAI,CAACsB,eAAL,CAAqBU,MAArB,CAA4BF,KAA5B,EAAmC,CAAnC;AACD;;AACD,WAAK3G,QAAL,CAAc6E,IAAd;AACD,KAlRkB;;AAAA,SAoRnB4B,0BApRmB,GAoRWC,aAAD,IAAmB;AAC9C,UAAI7B,IAAI,GAAG,KAAK1E,KAAhB;AACA,YAAMwG,KAAK,GAAG9B,IAAI,CAAC2B,gBAAL,CAAsBI,OAAtB,CAA8BF,aAA9B,CAAd;;AACA,UAAIC,KAAK,GAAG,CAAC,CAAb,EAAgB;AACd9B,QAAAA,IAAI,CAAC2B,gBAAL,CAAsBK,MAAtB,CAA6BF,KAA7B,EAAoC,CAApC;AACD;;AACD,WAAK3G,QAAL,CAAc6E,IAAd;AACD,KA3RkB;;AAAA,SA6RnBiC,wBA7RmB,GA6RQ,CAACC,WAAD,EAAcC,iBAAd,KAAoC;AAC7D,UAAInC,IAAI,GAAG,KAAK1E,KAAhB;AACA0E,MAAAA,IAAI,CAACsB,eAAL,CAAqBnE,IAArB,CAA0B+E,WAA1B;AACA,WAAK/G,QAAL,CAAc6E,IAAd;AAEA,YAAMoC,MAAM,GAAGZ,UAAU,CAAC,MAAM;AAC9B,aAAKC,yBAAL,CAA+BS,WAA/B;AACD,OAFwB,EAEtB,IAFsB,CAAzB;AAGD,KArSkB;;AAEjB,SAAKG,eAAL,GAAuB,KAAKA,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CAAvB;AACA,SAAKC,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBD,IAAtB,CAA2B,IAA3B,CAAxB;AACA,SAAKhH,KAAL,GAAa;AACX2E,MAAAA,YAAY,EAAE,CADH;AACM;AACjBG,MAAAA,YAAY,EAAE,UAFH;AAGXkB,MAAAA,eAAe,EAAE,EAHN;AAIXK,MAAAA,gBAAgB,EAAE,EAJP;AAIW;AACtB3C,MAAAA,cAAc,EAAE,CALL;AAMXC,MAAAA,cAAc,EAAE,CANL;AAOXW,MAAAA,kBAAkB,EAAE,CAPT;AAQXC,MAAAA,kBAAkB,EAAE,CART;AASXzC,MAAAA,KAAK,EAAE,KATI;AAUXC,MAAAA,kBAAkB,EAAE,CAVT;AAWXC,MAAAA,kBAAkB,EAAE,CAXT;AAYXC,MAAAA,SAAS,EAAE,CAZA;AAaXC,MAAAA,SAAS,EAAE,CAbA;AAcXN,MAAAA,SAAS,EAAE,CAdA;AAeX9B,MAAAA,MAAM,EAAE,CAfG;AAgBXO,MAAAA,YAAY,EAAE,EAhBH;AAiBXmD,MAAAA,WAAW,EAAE,CAjBF;AAkBXJ,MAAAA,YAAY,EAAE,CAlBH;AAmBXC,MAAAA,aAAa,EAAE,CAnBJ;AAoBXE,MAAAA,iBAAiB,EAAE,CApBR;AAqBXD,MAAAA,kBAAkB,EAAE,CArBT;AAsBXQ,MAAAA,mBAAmB,EAAE,CAtBV;AAuBXD,MAAAA,gBAAgB,EAAE,CAvBP;AAyBXqD,MAAAA,SAAS,EAAE;AAzBA,KAAb;AA4BA,SAAKjC,WAAL,GAAmB;AAAEA,MAAAA,WAAW,EAAE,EAAf;AAAmBlF,MAAAA,MAAM,EAAE;AAA3B,KAAnB;AACA,SAAKc,cAAL,GAAsB,EAAtB;AACA,SAAKL,kBAAL,GAA0B2G,SAA1B;AACA,SAAKC,eAAL,GAAuBD,SAAvB;AACA,SAAKE,iBAAL,GAAyBF,SAAzB;AACA,SAAKG,kBAAL,GAA0B,KAA1B;AACD;;AAEDC,EAAAA,iBAAiB,GAAG;AAClB,SAAKnI,SAAL;AACA,SAAKa,WAAL;AACA,SAAKK,gBAAL;AACA,SAAKnB,KAAL,CAAWY,MAAX,CAAkB,KAAKC,KAAL,CAAWF,MAA7B;AACD;;AA6EDiH,EAAAA,eAAe,CAACS,KAAD,EAAQ;AACrB,QAAItD,CAAC,GAAGsD,KAAK,CAACC,OAAd;AACA,QAAItD,CAAC,GAAGqD,KAAK,CAACE,OAAd;AACA,SAAK7H,QAAL,CAAc;AAAE6D,MAAAA,cAAc,EAAEQ,CAAlB;AAAqBP,MAAAA,cAAc,EAAEQ;AAArC,KAAd;AACD;;AAyDD8C,EAAAA,gBAAgB,CAACO,KAAD,EAAQ;AACtB,QAAI9C,IAAI,GAAG,KAAK1E,KAAhB;AACA,SAAK+G,eAAL,CAAqBS,KAArB;AACA,SAAK/D,sBAAL,CACE,KAAKzD,KAAL,CAAW0D,cADb,EAEE,KAAK1D,KAAL,CAAW2D,cAFb;AAIAe,IAAAA,IAAI,CAAC5C,KAAL,GAAa,IAAb;AACA4C,IAAAA,IAAI,CAACzC,SAAL,GAAiB,KAAKjC,KAAL,CAAW0D,cAA5B;AACAgB,IAAAA,IAAI,CAACxC,SAAL,GAAiB,KAAKlC,KAAL,CAAW2D,cAA5B;AACA,SAAK9D,QAAL,CAAc6E,IAAd;AACD;;AAqGDiD,EAAAA,MAAM,GAAG;AACP,wBACE;AAAK,MAAA,WAAW,EAAE,KAAKZ,eAAvB;AAAwC,MAAA,OAAO,EAAE,KAAKE,gBAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,WAAD;AACE,MAAA,aAAa,EAAE,KAAKN,wBADtB;AAEE,MAAA,mBAAmB,EAAE,KAAK5C,sBAF5B;AAGE,MAAA,QAAQ,EAAE,KAAK5E,KAAL,CAAWgB,QAHvB;AAIE,MAAA,UAAU,EAAE,KAAKqE,qBAJnB;AAKE,MAAA,UAAU,EAAE,KAAKI,qBALnB;AAME,MAAA,cAAc,EAAE,KAAKG,iBANvB;AAOE,MAAA,eAAe,EAAE,KAAKa,qBAPxB;AAQE,MAAA,gBAAgB,EAAE,KAAKQ,sBARzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF;AAcD;;AAvT6B;;AA0ThC,eAAenH,OAAf","sourcesContent":["import React, { Component } from \"react\";\r\nimport EmailClient from \"./emailClient\";\r\n\r\nclass Tracker extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleMouseMove = this.handleMouseMove.bind(this);\r\n    this.handleMouseClick = this.handleMouseClick.bind(this);\r\n    this.state = {\r\n      currentEmail: 0, //event dependant\r\n      currentInbox: \"AllInbox\",\r\n      insideEmailInfo: [],\r\n      outsideEmailInfo: [], //event dependant\r\n      mousePosXPlain: 0,\r\n      mousePosYPlain: 0,\r\n      mousePosXTransform: 0,\r\n      mousePosYTransform: 0,\r\n      click: false,\r\n      clickPosXTransform: 0,\r\n      clickPosYTransform: 0,\r\n      clickPosX: 0,\r\n      clickPosY: 0,\r\n      timeStamp: 0,\r\n      userId: 0,\r\n      userNickname: \"\",\r\n      pageScrollY: 0,\r\n      browserWidth: 0,\r\n      browserHeight: 0,\r\n      marginToScreenTop: 0,\r\n      marginToScreenLeft: 0,\r\n      inEmailScrollAmount: 0,\r\n      inEmailPositionY: 0,\r\n\r\n      submitted: true,\r\n    };\r\n\r\n    this.resultInbox = { resultInbox: [], userID: 0 };\r\n    this.stateCollector = [];\r\n    this.collectionInterval = undefined;\r\n    this.sendingInterval = undefined;\r\n    this.accuracyIntervall = undefined;\r\n    this.collectingAccuracy = false;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getUserID();\r\n    this.getNickname();\r\n    this.startCalibration();\r\n    this.props.userID(this.state.userId);\r\n  }\r\n\r\n  getUserID = () => {\r\n    const requestOptions = {\r\n      method: \"GET\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n    };\r\n\r\n    fetch(\"/connect\", requestOptions)\r\n      .then((response) => response.json())\r\n      .then((data) => this.setState({ userId: data.userID }))\r\n      .then(() => this.props.userID(this.state.userId));\r\n  };\r\n\r\n  getNickname = () => {\r\n    //set nickname from props\r\n    let nickname = this.props.userInfo.userName;\r\n    this.setState({ userNickname: nickname });\r\n  };\r\n\r\n  startCalibration = () => {\r\n    this.startTracking();\r\n  };\r\n\r\n  startTracking = () => {\r\n    this.collectionInterval = setInterval(this.collectStates, 250);\r\n    this.sendingIntervall = setInterval(this.sendData, 5000);\r\n  };\r\n\r\n  sendData = () => {\r\n    //Send to Server\r\n    const data = this.stateCollector;\r\n    const response = fetch(\"/data\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(data),\r\n    }).then(this.resetCollector);\r\n  };\r\n\r\n  collectStates = () => {\r\n    this.setAllInfo();\r\n    this.fillCollector();\r\n    this.resetStates();\r\n  };\r\n\r\n  setAllInfo = () => {\r\n    this.settingsChecker();\r\n    this.setTimestamp();\r\n  };\r\n\r\n  setTimestamp = () => {\r\n    let currentTime = new Date();\r\n    let newDate = currentTime.getTime();\r\n    this.setState({ timeStamp: newDate });\r\n  };\r\n\r\n  fillCollector = () => {\r\n    this.stateCollector.push(this.state);\r\n  };\r\n\r\n  resetCollector = () => {\r\n    this.stateCollector = [];\r\n  };\r\n\r\n  resetStates = () => {\r\n    this.setState({\r\n      click: false,\r\n      clickPosXTransform: 0,\r\n      clickPosYTransform: 0,\r\n      clickPosX: 0,\r\n      clickPosY: 0,\r\n    });\r\n  };\r\n\r\n  handleMouseMove(event) {\r\n    let x = event.clientX;\r\n    let y = event.clientY;\r\n    this.setState({ mousePosXPlain: x, mousePosYPlain: y });\r\n  }\r\n\r\n  settingsChecker = () => {\r\n    let width =\r\n      window.innerWidth ||\r\n      document.documentElement.clientWidth ||\r\n      document.body.clientWidth;\r\n\r\n    let height =\r\n      window.innerHeight ||\r\n      document.documentElement.clientHeight ||\r\n      document.body.clientHeight;\r\n\r\n    let marginTop = window.screenTop;\r\n    let marginLeft = window.screenLeft;\r\n\r\n    let yScroll = Math.round(window.scrollY);\r\n\r\n    this.setState({\r\n      browserWidth: width,\r\n      browserHeight: height,\r\n      marginToScreenLeft: marginLeft,\r\n      marginToScreenTop: marginTop,\r\n      pageScrollY: yScroll,\r\n    });\r\n\r\n    this.setTransformedMousePos(\r\n      this.state.mousePosXPlain,\r\n      this.state.mousePosYPlain\r\n    );\r\n\r\n    this.setinEmailPositionY();\r\n  };\r\n\r\n  setinEmailPositionY = () => {\r\n    let inEmailPositionY =\r\n      this.state.mousePosYPlain + this.state.inEmailScrollAmount;\r\n    this.setState({ inEmailPositionY: inEmailPositionY });\r\n  };\r\n\r\n  SetInEmailScrollAmount = (scrollAmount) => {\r\n    let roundScrollAmount = Math.round(scrollAmount);\r\n    this.setState({ inEmailScrollAmount: roundScrollAmount });\r\n  };\r\n\r\n  setTransformedMousePos = (x, y) => {\r\n    let clientWidth = 980;\r\n    if (x > this.state.browserWidth / 2 + clientWidth / 2) {\r\n      var xTran = (x - (this.state.browserWidth / 2 + clientWidth / 2)) * -1;\r\n      var yTran = y + this.state.pageScrollY;\r\n    } else {\r\n      var xTran = (this.state.browserWidth / 2 - clientWidth / 2 - x) * -1;\r\n      var yTran = y + this.state.pageScrollY;\r\n    }\r\n    this.setState({ mousePosXTransform: xTran, mousePosYTransform: yTran });\r\n  };\r\n\r\n  handleMouseClick(event) {\r\n    let copy = this.state;\r\n    this.handleMouseMove(event);\r\n    this.setTransformedMousePos(\r\n      this.state.mousePosXPlain,\r\n      this.state.mousePosYPlain\r\n    );\r\n    copy.click = true;\r\n    copy.clickPosX = this.state.mousePosXPlain;\r\n    copy.clickPosY = this.state.mousePosYPlain;\r\n    this.setState(copy);\r\n  }\r\n\r\n  handleNewCurrentEmail = (emailNr) => {\r\n    let copy = this.state;\r\n    copy.currentEmail = emailNr;\r\n    this.setState(copy);\r\n  };\r\n\r\n  handleNewCurrentInbox = (inboxType) => {\r\n    let copy = this.state;\r\n    copy.currentInbox = inboxType;\r\n    copy.currentEmail = 0;\r\n    this.setState(copy);\r\n  };\r\n\r\n  handleInboxResult = (finalInboxLocal) => {\r\n    this.resultInbox.resultInbox = finalInboxLocal;\r\n    this.resultInbox.resultInbox.forEach((element) => {\r\n      element.keyID = element.mail.defaultProps.keyID;\r\n      element.unseen = element.mail.defaultProps.unseen;\r\n    });\r\n    this.resultInbox.userID = this.state.userId;\r\n    this.sendFinalInbox();\r\n    clearInterval(this.collectionInterval);\r\n    clearInterval(this.sendingIntervall);\r\n  };\r\n\r\n  sendFinalInbox = () => {\r\n    //Send to Server\r\n\r\n    const data = this.resultInbox;\r\n    const response = fetch(\"/resultInbox\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(data),\r\n    }).then(console.log(\"sent result Inbox\"));\r\n  };\r\n\r\n  handleInsideEmailInfo = (InOrOutput, whichPart) => {\r\n    if (InOrOutput === true) {\r\n      let copy = this.state;\r\n      if (whichPart.includes(\"ClickedLink\")) {\r\n        copy.insideEmailInfo.push(whichPart);\r\n        const timerForClickedLink = setTimeout(() => {\r\n          this.deletefromInsideEmailInfo(whichPart);\r\n        }, 1000);\r\n        this.setState(copy);\r\n        this.sendData();\r\n        return;\r\n      }\r\n      if (!copy.insideEmailInfo.includes(whichPart)) {\r\n        copy.insideEmailInfo.push(whichPart);\r\n      } else {\r\n      }\r\n      this.setState(copy);\r\n    } else {\r\n      this.deletefromInsideEmailInfo(whichPart);\r\n    }\r\n  };\r\n\r\n  handleOutsideEmailInfo = (InOrOutput, whichPart) => {\r\n    if (InOrOutput === true) {\r\n      let copy = this.state;\r\n      copy.outsideEmailInfo.push(whichPart);\r\n      this.setState(copy);\r\n    } else {\r\n      this.deletefromOutsideEmailInfo(whichPart);\r\n    }\r\n  };\r\n\r\n  deletefromInsideEmailInfo = (whichToDelete) => {\r\n    let copy = this.state;\r\n    const index = copy.insideEmailInfo.indexOf(whichToDelete);\r\n    if (index > -1) {\r\n      copy.insideEmailInfo.splice(index, 1);\r\n    }\r\n    this.setState(copy);\r\n  };\r\n\r\n  deletefromOutsideEmailInfo = (whichToDelete) => {\r\n    let copy = this.state;\r\n    const index = copy.outsideEmailInfo.indexOf(whichToDelete);\r\n    if (index > -1) {\r\n      copy.outsideEmailInfo.splice(index, 1);\r\n    }\r\n    this.setState(copy);\r\n  };\r\n\r\n  handleClickedInboxButton = (whichButton, insideWhichButton) => {\r\n    let copy = this.state;\r\n    copy.insideEmailInfo.push(whichButton);\r\n    this.setState(copy);\r\n\r\n    const timer2 = setTimeout(() => {\r\n      this.deletefromInsideEmailInfo(whichButton);\r\n    }, 1050);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div onMouseMove={this.handleMouseMove} onClick={this.handleMouseClick}>\r\n        <EmailClient\r\n          clickedButton={this.handleClickedInboxButton}\r\n          inEmailScrollAmount={this.SetInEmailScrollAmount}\r\n          UserInfo={this.props.userInfo}\r\n          onNewEmail={this.handleNewCurrentEmail}\r\n          onNewInbox={this.handleNewCurrentInbox}\r\n          setInboxResult={this.handleInboxResult}\r\n          insideEmailInfo={this.handleInsideEmailInfo}\r\n          outsideEmailInfo={this.handleOutsideEmailInfo}\r\n        ></EmailClient>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Tracker;\r\n"]},"metadata":{},"sourceType":"module"}